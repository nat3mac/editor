<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport"
	      content="width=device-width, height=device-height, initial-scale=1, minimum-scale=1, viewport-fit=cover">
	<title>Med Chart</title>
	<link rel="stylesheet" href="app.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,700;1,400;1,500&display=swap"
	      rel="stylesheet">
	<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'"
	      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=block"/>
	<script>
		let oDoc, sDefTxt

		function initDoc () {
			oDoc = document.getElementById('input')
			sDefTxt = oDoc.innerHTML
			if (document.compForm.switchMode.checked) {
				setDocMode(true)
			}
		}

		function formatDoc (sCmd, sValue) {
			if (validateMode()) {
				document.execCommand(sCmd, false, sValue)
				oDoc.focus()
			}
		}

		function validateMode () {
			if (!document.compForm.switchMode.checked) {
				return true
			}
			alert('Uncheck "Show HTML".')
			oDoc.focus()
			return false
		}

		function setDocMode (bToSource) {
			let oContent
			if (bToSource) {
				oContent = document.createTextNode(oDoc.innerHTML)
				oDoc.innerHTML = ''
				var oPre = document.createElement('pre')
				oDoc.contentEditable = false
				oPre.id = 'sourceText'
				oPre.contentEditable = true
				oPre.appendChild(oContent)
				oDoc.appendChild(oPre)
				document.execCommand('defaultParagraphSeparator', false, 'div')
			} else {
				if (document.all) {
					oDoc.innerHTML = oDoc.innerText
				} else {
					oContent = document.createRange()
					oContent.selectNodeContents(oDoc.firstChild)
					oDoc.innerHTML = oContent.toString()
				}
				oDoc.contentEditable = true
			}
			oDoc.focus()
		}
	</script>
</head>
<body onload="initDoc();">
<header>
	<h1 class="heading">Charty Pants</h1>
	<nav>
		<button class="nav-trigger">
			<span class="icon">account_circle</span>
		</button>
		<ul class="nav-items">

		</ul>
	</nav>
</header>
<section class="details">
	<header>
		<img src="https://i.pravatar.cc/150?img=5" alt="">
		<div class="patient-name">
			<h2 class="heading">Jodie Tanner</h2>
			<p class="copy">10945773598</p>
		</div>
		<dl>
			<div>
				<dt>Age</dt>
				<dd>31</dd>
			</div>
			<div>
				<dt>Sex</dt>
				<dd>Female</dd>
			</div>
			<div>
				<dt>Height</dt>
				<dd>5'4"</dd>
			</div>
			<div>
				<dt>Weight</dt>
				<dd>131 lb</dd>
			</div>
			<div>
				<dt>Race</dt>
				<dd>Caucasian</dd>
			</div>
		</dl>
	</header>
	<details class="details-section">
		<summary class="subheading">Allergies</summary>
		<div class="content">A quis tempus urna ad ac feugiat augue fringilla sit ultricies enim cum parturient nisl at malesuada gravida. Cum venenatis parturient a at at eleifend ullamcorper rutrum eu curae rutrum facilisi taciti cum a torquent parturient hac suspendisse parturient lacinia malesuada parturient. Cras class eu tempor per a adipiscing suspendisse consectetur nisi nisl nullam orci volutpat fames posuere phasellus eleifend nisi dui id auctor nullam tellus ut aenean ad aptent posuere. Integer etiam quis curae class integer amet eu et aliquet porta penatibus non mus nec quis faucibus. Elementum potenti adipiscing enim eu nascetur vel a a congue habitasse nibh nam id viverra varius varius id. Parturient et a parturient ac scelerisque est suspendisse facilisis egestas in eleifend dis lacinia sociosqu.</div>
	</details>
	<details class="details-section">
		<summary class="subheading">Medications</summary>
		<div class="content">A quis tempus urna ad ac feugiat augue fringilla sit ultricies enim cum parturient nisl at malesuada gravida. Cum venenatis parturient a at at eleifend ullamcorper rutrum eu curae rutrum facilisi taciti cum a torquent parturient hac suspendisse parturient lacinia malesuada parturient. Cras class eu tempor per a adipiscing suspendisse consectetur nisi nisl nullam orci volutpat fames posuere phasellus eleifend nisi dui id auctor nullam tellus ut aenean ad aptent posuere. Integer etiam quis curae class integer amet eu et aliquet porta penatibus non mus nec quis faucibus. Elementum potenti adipiscing enim eu nascetur vel a a congue habitasse nibh nam id viverra varius varius id. Parturient et a parturient ac scelerisque est suspendisse facilisis egestas in eleifend dis lacinia sociosqu.</div>
	</details>
	<details class="details-section">
		<summary class="subheading">Active Problems</summary>
		<div class="content">A quis tempus urna ad ac feugiat augue fringilla sit ultricies enim cum parturient nisl at malesuada gravida. Cum venenatis parturient a at at eleifend ullamcorper rutrum eu curae rutrum facilisi taciti cum a torquent parturient hac suspendisse parturient lacinia malesuada parturient. Cras class eu tempor per a adipiscing suspendisse consectetur nisi nisl nullam orci volutpat fames posuere phasellus eleifend nisi dui id auctor nullam tellus ut aenean ad aptent posuere. Integer etiam quis curae class integer amet eu et aliquet porta penatibus non mus nec quis faucibus. Elementum potenti adipiscing enim eu nascetur vel a a congue habitasse nibh nam id viverra varius varius id. Parturient et a parturient ac scelerisque est suspendisse facilisis egestas in eleifend dis lacinia sociosqu.</div>
	</details>
	<details class="details-section">
		<summary class="subheading">Last Filed Vitals</summary>
		<div class="content">A quis tempus urna ad ac feugiat augue fringilla sit ultricies enim cum parturient nisl at malesuada gravida. Cum venenatis parturient a at at eleifend ullamcorper rutrum eu curae rutrum facilisi taciti cum a torquent parturient hac suspendisse parturient lacinia malesuada parturient. Cras class eu tempor per a adipiscing suspendisse consectetur nisi nisl nullam orci volutpat fames posuere phasellus eleifend nisi dui id auctor nullam tellus ut aenean ad aptent posuere. Integer etiam quis curae class integer amet eu et aliquet porta penatibus non mus nec quis faucibus. Elementum potenti adipiscing enim eu nascetur vel a a congue habitasse nibh nam id viverra varius varius id. Parturient et a parturient ac scelerisque est suspendisse facilisis egestas in eleifend dis lacinia sociosqu.</div>
	</details>
</section>
<section class="editor">
	<header>
		<h3 class="heading">Visit notes</h3>
		<time class="copy">2:21<small> PM</small> 18 Jul, 2022</time>
	</header>
	<div class="toolbar">
		<div class="button-group">
			<button onclick="formatDoc('undo');">
				<span class="icon">undo</span>
			</button>
			<button onclick="formatDoc('redo');">
				<span class="icon">redo</span>
			</button>
		</div>
		<button class="intLink"
		        onclick="var sLnk=prompt('Write the URL here','http:\/\/');if(sLnk&&sLnk!=''&&sLnk!='http://'){formatDoc('createlink',sLnk)}">
			<span class="icon">add_link</span>
		</button>
		<button onclick="formatDoc('cut');">
			<span class="icon">content_cut</span>
		</button>
		<button onclick="formatDoc('copy');">
			<span class="icon">content_copy</span>
		</button>
		<button onclick="formatDoc('paste');">
			<span class="icon">content_paste</span>
		</button>
		<button onclick="formatDoc('removeFormat')">
			<span class="icon">format_clear</span>
		</button>
		<div class="button-group">
			<button onclick="formatDoc('bold');">
				<span class="icon">format_bold</span>
			</button>
			<button onclick="formatDoc('italic');">
				<span class="icon">format_italic</span>
			</button>
			<button onclick="formatDoc('underline');">
				<span class="icon">format_underlined</span>
			</button>
		</div>
		<div class="button-group">
			<button onclick="formatDoc('justifyleft');">
				<span class="icon">format_align_left</span>
			</button>
			<button onclick="formatDoc('justifycenter');">
				<span class="icon">format_align_center</span>
			</button>
			<button onclick="formatDoc('justifyright');">
				<span class="icon">format_align_right</span>
			</button>
		</div>
		<button onclick="formatDoc('insertorderedlist');">
			<span class="icon">format_list_numbered</span>
		</button>
		<button onclick="formatDoc('insertunorderedlist');">
			<span class="icon">format_list_bulleted</span>
		</button>
		<button onclick="formatDoc('formatblock','blockquote');">
			<span class="icon">format_quote</span>
		</button>
		<button onclick="formatDoc('outdent');">
			<span class="icon">format_indent_decrease</span>
		</button>
		<button onclick="formatDoc('indent');">
			<span class="icon">format_indent_increase</span>
		</button>
	</div>
	<form name="compForm" method="post" id="chart"
	      onsubmit="if(validateMode()){this.myDoc.value=oDoc.innerHTML;return true;}return false;">
		<input type="hidden" name="myDoc">
		<div id="input" contenteditable="true"><p class="copy">Visit notes</p></div>
	</form>
	<footer>
		<!--		<p id="editMode"><input type="checkbox" name="switchMode" id="switchBox" onchange="setDocMode(this.checked);"/>-->
		<!--			<label for="switchBox">Show HTML</label></p>-->
		<button type="submit" form="chart" class="button">Save Changes</button>
	</footer>
</section>
<script>
	class Accordion {
		constructor (el) {
			// Store the <details> element
			this.el = el
			// Store the <summary> element
			this.summary = el.querySelector('summary')
			// Store the <div class="content"> element
			this.content = el.querySelector('.content')

			// Store the animation object (so we can cancel it if needed)
			this.animation = null
			// Store if the element is closing
			this.isClosing = false
			// Store if the element is expanding
			this.isExpanding = false
			// Detect user clicks on the summary element
			this.summary.addEventListener('click', (e) => this.onClick(e))
		}

		onClick (e) {
			// Stop default behaviour from the browser
			e.preventDefault()
			// Add an overflow on the <details> to avoid content overflowing
			this.el.style.overflow = 'hidden'
			// Check if the element is being closed or is already closed
			if (this.isClosing || !this.el.open) {
				this.open()
				// Check if the element is being openned or is already open
			} else if (this.isExpanding || this.el.open) {
				this.shrink()
			}
		}

		shrink () {
			// Set the element as "being closed"
			this.isClosing = true

			// Store the current height of the element
			const startHeight = `${this.el.offsetHeight}px`
			// Calculate the height of the summary
			const endHeight = `${this.summary.offsetHeight * 2}px`

			// If there is already an animation running
			if (this.animation) {
				// Cancel the current animation
				this.animation.cancel()
			}

			// Start a WAAPI animation
			this.animation = this.el.animate({
				// Set the keyframes from the startHeight to endHeight
				height: [ startHeight, endHeight ]
			}, {
				duration: 400,
				easing: 'ease-out'
			})

			this.animation = this.content.animate({
				opacity: [1,0]
			}, {
				duration: 400,
				easing: 'ease-out'
			})

			// When the animation is complete, call onAnimationFinish()
			this.animation.onfinish = () => this.onAnimationFinish(false)
			// If the animation is cancelled, isClosing variable is set to false
			this.animation.oncancel = () => this.isClosing = false
		}

		open () {
			// Apply a fixed height on the element
			this.el.style.height = `${this.el.offsetHeight}px`
			// Force the [open] attribute on the details element
			this.el.open = true
			// Wait for the next frame to call the expand function
			window.requestAnimationFrame(() => this.expand())
		}

		expand () {
			// Set the element as "being expanding"
			this.isExpanding = true
			// Get the current fixed height of the element
			const startHeight = `${this.el.offsetHeight}px`
			// Calculate the open height of the element (summary height + content height)
			const endHeight = `${this.summary.offsetHeight * 2 + this.content.offsetHeight}px`

			// If there is already an animation running
			if (this.animation) {
				// Cancel the current animation
				this.animation.cancel()
			}

			// Start a WAAPI animation
			this.animation = this.el.animate({
				// Set the keyframes from the startHeight to endHeight
				height: [ startHeight, endHeight ],
			}, {
				duration: 400,
				easing: 'ease-out'
			})

			this.animation = this.content.animate({
				opacity: [0,1]
			}, {
				duration: 400,
				easing: 'ease-out'
			})

			// When the animation is complete, call onAnimationFinish()
			this.animation.onfinish = () => this.onAnimationFinish(true)
			// If the animation is cancelled, isExpanding variable is set to false
			this.animation.oncancel = () => this.isExpanding = false
		}

		onAnimationFinish (open) {
			// Set the open attribute based on the parameter
			this.el.open = open
			// Clear the stored animation
			this.animation = null
			// Reset isClosing & isExpanding
			this.isClosing = false
			this.isExpanding = false
			// Remove the overflow hidden and the fixed height
			this.el.style.height = this.el.style.overflow = ''
		}
	}
</script>
<script>
	document.querySelectorAll('details').forEach((el) => {
		new Accordion(el)
	})
</script>
</body>
</html>